% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/TBtypeR.R
\name{tbtype}
\alias{tbtype}
\title{Identify and quantify Mycobacterium tuberculosis (MTB) phylotype mixtures from genomic data}
\usage{
tbtype(
  gds = NULL,
  vcf = NULL,
  allele_counts = NULL,
  panel = TBtypeR::tbt_panel,
  max_phylotypes = 5L,
  min_mix_prop = 0.005,
  min_median_depth = 10L,
  min_depth_fold = 5,
  max_depth = 200L,
  max_depth_fold = 2,
  max_p_val_perm = 0.01,
  max_p_val_wsrst = 0.01,
  reoptimise = TRUE,
  min_sites = 1000L,
  n_perm = 1000L,
  exclude_parent = TRUE,
  exclude_child = TRUE,
  exclude_ancestor = TRUE,
  exclude_descendant = FALSE,
  exclude_distance = 10L,
  exclude_inner = FALSE,
  error_rate = 0.005,
  verbose = FALSE,
  seed = 1L
)
}
\arguments{
\item{gds}{A Genomic Data Structure (GDS) file. Default is NULL. One of \code{gds}, \code{vcf}, or \code{allele_counts} must be supplied.}

\item{vcf}{A Variant Call Format (VCF) file. Default is NULL. One of \code{gds}, \code{vcf}, or \code{allele_counts} must be supplied.}

\item{allele_counts}{Allele count matrix. Default is NULL. One of \code{gds}, \code{vcf}, or \code{allele_counts} must be supplied.}

\item{panel}{The phylogenetic SNP panel (barcode) to use. Default is \code{TBtypeR::tbt_panel}.}

\item{max_phylotypes}{Maximum number of phylotypes to identify. Default is 5L.}

\item{min_mix_prop}{Minimum proportion of a mixture required to return a result. Default is 0.005.}

\item{min_median_depth}{Minimum median depth of coverage required to return calls. Default is 10L.}

\item{min_depth_fold}{Exclude sites with coverage this many times below median depth. Default is 5.}

\item{max_depth}{Round allele counts above this value down. Default is 200L.}

\item{max_depth_fold}{Round allele counts this many times above median down. Default is 2.}

\item{max_p_val_perm}{Maximum p-value for permutation test to consider a significant mixture. Default is 0.01.}

\item{max_p_val_wsrst}{Maximum p-value for Wilcoxon signed-rank test to consider a significant mixture. Default is 0.01.}

\item{reoptimise}{Logical, whether to reoptimise phylotype calls each iteration. Default is TRUE.}

\item{min_sites}{Minimum number of sites required for a reliable mixture call. Default is 1000L.}

\item{n_perm}{Number of permutations for permutation test. Default is 1000L.}

\item{exclude_parent}{Logical, whether to exclude parent phylotypes. Default is TRUE.}

\item{exclude_child}{Logical, whether to exclude child phylotypes. Default is TRUE.}

\item{exclude_ancestor}{Logical, whether to exclude ancestor phylotypes. Default is TRUE.}

\item{exclude_descendant}{Logical, whether to exclude descendant phylotypes. Default is FALSE.}

\item{exclude_distance}{Maximum distance to exclude close relatives. Default is 10L.}

\item{exclude_inner}{Logical, whether to exclude inner nodes in the phylogeny. Default is FALSE.}

\item{error_rate}{Error rate for sequencing. Default is 0.005.}

\item{verbose}{Logical, whether to print detailed messages during execution. Default is FALSE.}

\item{seed}{Seed for random number generation. Default is 1L.}
}
\value{
A tibble containing identified phylotypes and their mixture proportions.
}
\description{
Identify and quantify Mycobacterium tuberculosis (MTB) phylotype mixtures from genomic data
}
\examples{
\dontrun{
tbtype_result <- tbtype(gds = "example.gds", max_phylotypes = 3L, min_mix_prop = 0.01)
}
}
